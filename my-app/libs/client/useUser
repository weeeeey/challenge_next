import useSWR from "swr";

interface ProfileResponse {
  ok: boolean;
  profile: {
    name: string;
    email: string;
  };
}

const fetcher = (url: string) => fetch(url).then((response) => response.json());

const useUser = () => {
  const { data, error } = useSWR<ProfileResponse>("/api/profile", fetcher);

  return { user: data?.profile, isLoading: !data && !error };
};

export default useUser;

// useSWR을 사용하지 않으면 다른 페이지에 갔다가 다시 index page로 오면 user 정보에 대해 한번 더
// fetch를 통해 요청을 보낸다. 즉 이미 가져온 데이테에 대해 다시 undefined 됐다가 json 을 긁어옴
// useSWR을 사용해서 캐시에 있는 이전 데이터를 가져오는것으로 위에 이슈를 해결함
